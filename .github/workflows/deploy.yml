name: Deploy to Namecheap

    - name: üìÇ Sync applicatio    - name: üöö Get latest code
      uses: actions/checkout@v4
      
    - name: üîß Prepare hosting-specific files
      run: |
        # Copy hosting-specific index.php
        cp public/index-hosting.php public/index.php
      
    - name: üîç Debug server configurationles to hosting
      uses: SamKirkland/FTP-Deploy-Action@v4.3.4
      env:
        INPUT_SERVER: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
      with:
        server: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        protocol: ftp
        port: 21
        passive: true
        timeout: 300000
        dangerous-clean-slate: false
        local-dir: ./
        server-dir: tc_app/
        exclude: |
          **/.git*
          **/.git*/**
          **/node_modules/**
          **/tests/**
          **/.env
          **/storage/logs/**
          **/storage/framework/cache/**
          **/storage/framework/sessions/**
          **/storage/framework/views/**
          **/public/**
          
    - name: üåê Sync public files to web directory
      uses: SamKirkland/FTP-Deploy-Action@v4.3.4
      env:
        INPUT_SERVER: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
      with:
        server: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        protocol: ftp
        port: 21
        passive: true
        timeout: 300000
        dangerous-clean-slate: false
        local-dir: ./public/
        server-dir: public_html/tc/ branches: [ master ]
  workflow_dispatch:
    inputs:
      server:
        description: 'FTP server address (e.g. ftp.beelsimon.com)'
        required: false
        default: 'ftp.beelsimon.com'

jobs:
  deploy:
    name: Deploy to Production
    runs-on: ubuntu-latest
    
    steps:
    - name: üöö Get latest code
      uses: actions/checkout@v4
      
    - name: ÔøΩ Debug server configuration
      run: |
        echo "Server from input: '${{ github.event.inputs.server }}'"
        echo "Fallback server: 'ftp.beelsimon.com'"
        echo "Final server: '${{ github.event.inputs.server || 'ftp.beelsimon.com' }}'"
      
    - name: ÔøΩüìÇ Sync files to hosting
      uses: SamKirkland/FTP-Deploy-Action@v4.3.4
      env:
        INPUT_SERVER: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
      with:
        server: ${{ github.event.inputs.server || 'ftp.beelsimon.com' }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        protocol: ftp
        port: 21
        passive: true
        timeout: 300000
        dangerous-clean-slate: false
        local-dir: ./public/
        server-dir: public_html/tc/
        exclude: |
          **/.git*
          **/.git*/**
          **/node_modules/**
          **/tests/**
          **/.env
          **/storage/logs/**
          **/storage/framework/cache/**
          **/storage/framework/sessions/**
          **/storage/framework/views/**
          
    # SSH deployment commands disabled until credentials are configured
    # - name: üîß Run deployment commands
    #   uses: appleboy/ssh-action@v1.0.0
    #   with:
    #     host: ${{ secrets.SSH_HOST || 'beelsimon.com' }}
    #     username: ${{ secrets.SSH_USERNAME }}
    #     password: ${{ secrets.SSH_PASSWORD }}
    #     port: ${{ secrets.SSH_PORT || '22' }}
    #     script: |
    #       cd public_html/tc
    #       # Install/update dependencies
    #       /usr/local/bin/php composer.phar install --no-dev --optimize-autoloader --no-interaction
    #       
    #       # Run Laravel/Statamic commands
    #       /usr/local/bin/php artisan config:cache
    #       /usr/local/bin/php artisan route:cache
    #       /usr/local/bin/php artisan view:cache
    #       /usr/local/bin/php artisan statamic:stache:clear
    #       /usr/local/bin/php artisan statamic:stache:warm
    #       
    #       # Set permissions
    #       chmod -R 755 storage bootstrap/cache
    #       
    #       echo "‚úÖ Deployment completed successfully!"
